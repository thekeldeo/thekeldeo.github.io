<!DOCTYPE html>
<html lang="vi">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Hướng dẫn SEO Web trong MEAN STACK</title>
  <meta name="description" content="MEAN stack là một combo tuyệt vời sử dụng SPA và client rendering, rất phù hợp với webapp cho admin, stuff ,… Nhưng vấn đề khá lớn của Mean Stack nói riêng v...">
  <link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin-ext,vietnamese" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,700&amp;subset=vietnamese" rel="stylesheet">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/dev/2017/08/03/seo-with-mean-stack..html">
  <link rel="alternate" type="application/rss+xml" title="SecretSword Blog" href="/feed.xml">

  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/">
      <div class="logo">
        <img class="" src="/assets/img/logo.jpg" alt="SecretSword Blog">
      </div>
      <p>SecretSword Blog</p>
    </a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/about/">About me</a>
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Hướng dẫn SEO Web trong MEAN STACK</h1>
    <p class="post-meta">
      Publish:
      <time datetime="2017-08-03T14:27:58+07:00" itemprop="datePublished">
        
        03 Aug, 2017
      </time>
      </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>MEAN stack là một combo tuyệt vời sử dụng SPA và client rendering, rất phù hợp với webapp cho admin, stuff ,…
Nhưng vấn đề khá lớn của Mean Stack nói riêng và những framework client rendering nói chung đó là rất khó để những con bot như google có thể crawl được dữ liệu.</p>

<p>Hôm nay tôi sẽ hướng dẫn mọi người khắc phục vẫn đề này một phần nào đó !.</p>

<h2 id="vấn-đề">Vấn đề</h2>

<p><strong>Client rendering</strong> tức là <strong>server</strong> sẽ chỉ trả lại cho trình duyệt các file dữ liệu, việc thực thi các file này để render ra trang web là công việc của browsers. Điều này khá là tuyệt, sẽ giảm bớt công việc cho server của bạn, nhưng đồng thời làm những công cụ crawl dữ liệu như google sẽ chỉ nhận được các dòng javascript của bạn thay vì html hoàn chỉnh.</p>

<p>Nếu các bạn search trang web bằng angularjs của mình trên google có thể các bạn sẽ thấy google đọc description hay title của web thành <code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="err">page_title</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="err">}</span></code> , <code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="err">{page_description</span><span class="p">}</span><span class="w"> </span><span class="err">}</span></code> thay vì nội dung được render khi gọi api từ server về.</p>

<p><img src="/assets/img/angular-seo/Screen%20Shot%202017-08-03%20at%2014.46.42.png" alt="angular-seo-problem" /></p>

<h2 id="giải-pháp">Giải pháp</h2>

<p>Thật ra đây không phải là một cách tối ưu nhất, nếu bạn muốn chú trọng về seo, tốt nhất hãy sử dụng các framework rendering server, nhưng trong trường hợp này 
có thể khắc phục được khá nhiều đó. Chúng ta sẽ sử dụng <a href="https://prerender.io"><strong>Prerender.io</strong></a>, một framework cho phép chúng ta cache lại web đã được render từ trước, để khi các bot crawl data sẽ lấy được data đã được render.</p>

<p><em>Note: Prerender chỉ free cache lại 200 page đầu tiên thôi, nên nếu web bạn có nhiều hơn thì sẽ phải trả tiền đó.</em></p>

<h2 id="1-cấu-hình-trên-server">1. Cấu hình trên server</h2>

<h3 id="express">Express</h3>

<p>Hãy cài package của prerender trên project:</p>

<p><code class="highlighter-rouge">npm install prerender-node --save</code></p>

<p>Và settup express app:</p>

<p><code class="highlighter-rouge">app.use(require('prerender-node').set('prerenderToken', 'YOUR_TOKEN'));</code></p>

<pre><code class="language-$xslt">// server.js

var express = require('express');

var app = module.exports = express();

app.configure(function(){ 
  // Here we require the prerender middleware that will handle requests from Search Engine crawlers 
  // We set the token only if we're using the Prerender.io service 
  app.use(require('prerender-node').set('prerenderToken', 'YOUR-TOKEN-HERE')); 
  app.use(express.static("public")); app.use(app.router); 
});

// This will ensure that all routing is handed over to AngularJS 
app.get('*', function(req, res){ 
  res.sendfile('./public/index.html'); 
});

app.listen(8081); 
console.log("Go Prerender Go!");
</code></pre>

<h3 id="nginx">Nginx</h3>

<p>Cấu hình lại file config và restart lại nginx. Bạn có thể config theo file <a href="https://gist.github.com/thoop/8165802">này</a></p>

<h3 id="apache">Apache</h3>

<p>Nếu bạn sử dụng Apache, hãy config file <code class="highlighter-rouge">.htaccess</code> theo file <a href="https://gist.github.com/thoop/8072354">này</a> và restart lại apache.</p>

<h2 id="2-cấu-hình-ở-client">2. Cấu hình ở client</h2>

<p>Rất đơn giản, hãy thêm dòng code sau ở thẻ <em>head</em> ở file <code class="highlighter-rouge">index.html</code></p>

<p><code class="highlighter-rouge">&lt;meta name="fragment" content="!"&gt;</code></p>

<p>Thẻ này sẽ làm cho các search engine nhận ra đây là một web có nội dung dynamic bằng javascript.</p>

<p>Sau khi hoàn thành config mọi thứ xong đây là quy trình sẽ crawl web của bạn:</p>

<ul>
  <li>Bot sẽ craw web của bạn ở url <em>http://localhost:3000/#!/home</em></li>
  <li>Url sẽ được chuyển thành <em>http://localhost:3000/?<em>escaped_fragment</em>=/home</em></li>
  <li>Prerender sẽ check nếu cache của địa chỉ này đã được lưu lại hay chưa, nếu có, nó sẽ gửi cho bot crawl, nếu không nó render và cache lại sau đó gửi cho bot crawl</li>
</ul>

<p><em>Note: Nếu bạn sử dụng html5mode, thì url từ <code class="highlighter-rouge">http://localhost:3000/home</code> sẽ được chuyển thành <code class="highlighter-rouge">http://localhost:3000/home/?&lt;em&gt;escaped_fragment&lt;/em&gt;=</code></em></p>

<h2 id="3-kiểm-tra-mọi-thứ-đã-hoạt-động-ổn-định">3. Kiểm tra mọi thứ đã hoạt động ổn định</h2>

<p>Bạn có thể vào một page bất kì nào trên trang web của bạn và thêm param <em><code class="highlighter-rouge">?&lt;em&gt;escaped_fragment&lt;/em&gt;=</code></em> để kiểm tra, <code class="highlighter-rouge">ctrl + u</code> để view source trang. Nếu thấy data hml được render thì chúc mừng  bạn đã thành công rồi đó.</p>

<p>Bạn cũng có thể vào dashboard của prerender để kiểm tra:</p>

<p><img src="/assets/img/angular-seo/Screen%20Shot%202017-08-03%20at%2015.56.50.png" alt="angular-seo" /></p>

<p>Bạn cũng có thể thêm các param trong dashboard để khiên prerender không crawl những trang đó</p>

<p><img src="/assets/img/angular-seo/Screen%20Shot%202017-08-03%20at%2015.54.07.png" alt="angular-seo" /></p>

  </div>

  
</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <!--<h2 class="footer-heading">SecretSword Blog</h2>-->

    <!--<div class="footer-col-wrapper">-->
      <!--<div class="footer-col footer-col-1">-->
        <!--<ul class="contact-list">-->
          <!--<li>-->
            <!---->
              <!--SecretSword-->
            <!---->
            <!--</li>-->
            <!---->
            <!--<li><a href="mailto:khanhktong@gmail.com">khanhktong@gmail.com</a></li>-->
            <!---->
        <!--</ul>-->
      <!--</div>-->

      <!--<div class="footer-col footer-col-2">-->
        <!--<ul class="social-media-list">-->
          <!---->
          <!--<li>-->
            <!--<a href="https://github.com/thekeldeo"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">thekeldeo</span></a>
-->
          <!--</li>-->
          <!---->

          <!---->
        <!--</ul>-->
      <!--</div>-->

      <!--<div class="footer-col footer-col-3">-->
        <!--<p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
</p>-->
      <!--</div>-->
    <!--</div>-->

    <div class="text-center">
      &copy; 2017 &#8226; <a target="_blank" href="https://facebook.com/secret.i.cant.tell.5">SecretSword</a>

    </div>

  </div>

</footer>


  </body>

</html>
